
{ config, lib, pkgs, ... }:

{
  # PORTALS
  xdg = {
    autostart.enable = true;
    portal = {
      enable = true;
      extraPortals = [
        pkgs.xdg-desktop-portal
        pkgs.xdg-desktop-portal-gtk
      ];
    };
  };

  services = {
    xserver = {
      enable = true;
      layout = "latam";
      excludePackages = [ pkgs.xterm ];
      libinput.enable = true;
      displayManager.gdm = {
        enable = true;
        wayland = true;
      };
    };
    dbus.enable = true;
    gvfs.enable = true;
    tumbler.enable = true;
    gnome = {
      sushi.enable = true;
      gnome-keyring,enable = true;    
    };
  };

  # WAYLAND
  programs.hyprland = {
    enable = true;
    #nvidiaPatches = true;
    xwayland.enable = true;
  };

  environment.sessionVariables = {
    # WLR_NO_HARDWARE_CURSORS = "1"; # if cursor becomes invisible
    NIXOS_OZONE_WL = "1";
  };

  #hardware.opengl = {
  #  enable = true;
  #  driSupport = true;

    # most wayland compositors need this
    # nvidia.modesetting.enable = true;
  #};

  services.xserver.enable = true;
  #services.xserver.videoDrivers = [ "amdgpu" ];
}
